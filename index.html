<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @keyframes blink {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0;
        }
      }
      .cursor-blink {
        animation: blink 1s infinite;
      }
    </style>
  </head>
  <body class="bg-gray-100 p-4 flex items-center justify-center min-h-[400px]">
    <div
      class="w-full max-w-md bg-white rounded-xl border border-gray-200 shadow-lg overflow-hidden font-sans">
      <!-- Header -->
      <div
        class="bg-slate-900 text-white p-4 flex justify-between items-center">
        <div class="flex items-center gap-2">
          <!-- Icon -->
          <svg
            class="w-5 h-5 text-blue-400"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
          </svg>
          <span class="font-bold">AI 자막 테스트</span>
        </div>
        <div
          id="status-badge"
          class="text-xs bg-slate-800 px-2 py-1 rounded text-slate-300">
          대기 중
        </div>
      </div>

      <div class="p-6 space-y-6">
        <!-- Mode Switcher -->
        <div class="grid grid-cols-2 gap-3">
          <button
            id="btn-word"
            onclick="setMode('WORD')"
            class="p-3 rounded-lg border-2 text-sm font-bold transition-all flex flex-col items-center gap-2 border-blue-500 bg-blue-50 text-blue-700">
            <span>WORD 모드</span>
            <span class="text-[10px] font-normal opacity-70"
              >타자 치듯 출력</span
            >
          </button>
          <button
            id="btn-text"
            onclick="setMode('TEXT')"
            class="p-3 rounded-lg border-2 text-sm font-bold transition-all flex flex-col items-center gap-2 border-gray-200 text-gray-400 hover:border-gray-300">
            <span>TEXT 모드</span>
            <span class="text-[10px] font-normal opacity-70"
              >완성된 문장 출력</span
            >
          </button>
        </div>

        <!-- Screen Area -->
        <div
          class="relative bg-white border border-gray-200 rounded-xl h-40 shadow-inner flex flex-col">
          <!-- Progress Bar -->
          <div class="h-1 bg-gray-100 w-full">
            <div
              id="progress-bar"
              class="h-full bg-blue-500 transition-all duration-100"
              style="width: 0%"></div>
          </div>

          <div class="flex-1 p-4 flex items-center justify-center text-center">
            <p
              id="display-text"
              class="text-lg font-medium text-gray-800 leading-relaxed">
              <span class="text-gray-400 text-sm">아래 버튼을 눌러보세요</span>
            </p>
          </div>
        </div>

        <!-- Action Button -->
        <button
          id="action-btn"
          onclick="startSimulation()"
          class="w-full py-4 rounded-xl font-bold text-white shadow-md transition-transform active:scale-95 bg-blue-600 hover:bg-blue-700 flex items-center justify-center gap-2">
          시뮬레이션 시작
        </button>
      </div>
    </div>

    <script>
      let currentMode = "WORD";
      let isAnimating = false;
      const fullText =
        "네, Frank Kim님. 예약하신 날짜에 방문이 가능합니다. 더 필요하신 게 있으신가요?";

      const btnWord = document.getElementById("btn-word");
      const btnText = document.getElementById("btn-text");
      const progressBar = document.getElementById("progress-bar");
      const displayText = document.getElementById("display-text");
      const actionBtn = document.getElementById("action-btn");
      const statusBadge = document.getElementById("status-badge");

      function setMode(mode) {
        if (isAnimating) return;
        currentMode = mode;

        // Update UI styles
        if (mode === "WORD") {
          btnWord.className =
            "p-3 rounded-lg border-2 text-sm font-bold transition-all flex flex-col items-center gap-2 border-blue-500 bg-blue-50 text-blue-700";
          btnText.className =
            "p-3 rounded-lg border-2 text-sm font-bold transition-all flex flex-col items-center gap-2 border-gray-200 text-gray-400 hover:border-gray-300";
          progressBar.className =
            "h-full bg-blue-500 transition-all duration-100";
          actionBtn.className =
            "w-full py-4 rounded-xl font-bold text-white shadow-md transition-transform active:scale-95 bg-blue-600 hover:bg-blue-700 flex items-center justify-center gap-2";
          statusBadge.innerText = "실시간 스트리밍 모드";
        } else {
          btnWord.className =
            "p-3 rounded-lg border-2 text-sm font-bold transition-all flex flex-col items-center gap-2 border-gray-200 text-gray-400 hover:border-gray-300";
          btnText.className =
            "p-3 rounded-lg border-2 text-sm font-bold transition-all flex flex-col items-center gap-2 border-purple-500 bg-purple-50 text-purple-700";
          progressBar.className =
            "h-full bg-purple-500 transition-all duration-100";
          actionBtn.className =
            "w-full py-4 rounded-xl font-bold text-white shadow-md transition-transform active:scale-95 bg-purple-600 hover:bg-purple-700 flex items-center justify-center gap-2";
          statusBadge.innerText = "메시지 수신 모드";
        }
      }

      function startSimulation() {
        if (isAnimating) return;
        isAnimating = true;
        actionBtn.disabled = true;
        actionBtn.innerText = "처리 중...";
        actionBtn.classList.add("opacity-75", "cursor-not-allowed");

        displayText.innerText = "";
        progressBar.style.width = "0%";

        if (currentMode === "WORD") {
          // WORD Mode Logic
          const chars = fullText.split("");
          let i = 0;
          const interval = setInterval(() => {
            if (i < chars.length) {
              displayText.innerHTML =
                fullText.substring(0, i + 1) +
                '<span class="inline-block w-0.5 h-5 ml-0.5 bg-blue-500 cursor-blink align-middle"></span>';
              i++;
              progressBar.style.width = (i / chars.length) * 100 + "%";
            } else {
              clearInterval(interval);
              displayText.innerHTML = fullText; // Remove cursor
              finishAnimation();
            }
          }, 50);
        } else {
          // TEXT Mode Logic
          displayText.innerHTML =
            '<span class="text-gray-400 text-sm animate-pulse">답변 생성 중...</span>';
          let p = 0;
          const pInterval = setInterval(() => {
            p += 5;
            if (p < 90) progressBar.style.width = p + "%";
          }, 50);

          setTimeout(() => {
            clearInterval(pInterval);
            progressBar.style.width = "100%";
            displayText.innerText = fullText;
            finishAnimation();
          }, 1500);
        }
      }

      function finishAnimation() {
        isAnimating = false;
        actionBtn.disabled = false;
        actionBtn.innerText = "시뮬레이션 다시 시작";
        actionBtn.classList.remove("opacity-75", "cursor-not-allowed");
      }
    </script>
  </body>
</html>
